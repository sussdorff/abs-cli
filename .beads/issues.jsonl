{"id":"abs-cli-30f","title":"[EPIC] abs-cli: Audiobookshelf CLI Tool","description":"## Ziel\nCLI-Tool für Audiobookshelf, das die REST-API kapselt und häufige Operationen einfach zugänglich macht.\n\n## Tech Stack\n- Python 3.12+, UV als Package Manager\n- Click für CLI-Framework\n- httpx für HTTP-Requests\n- Config: XDG-konform (~/.config/abs-cli/config.toml)\n- Auth: API-Token aus Config oder 1Password (op CLI)\n\n## Sub-Tasks\n- Projekt-Scaffolding (Click, httpx, Config-Handling)\n- Auth (API-Token aus Config + 1Password-Integration)\n- Library-Kommandos (list, scan, stats)\n- Item-Kommandos (list, show, match, delete, search)\n- Progress-Kommandos (list, sync-from-libation)\n- Packaging (uv build, CLI entry point)","status":"closed","priority":1,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-17T19:06:33Z","created_by":"Malte Sussdorff","updated_at":"2026-02-17T20:25:25Z","closed_at":"2026-02-17T20:25:25Z","close_reason":"Alle 4 Sub-Tasks implementiert: Scaffolding, Library (3 cmds), Items (5 cmds), Progress (2 cmds + Libation sync)"}
{"id":"abs-cli-5ab","title":"library scan: --force Flag und Scan-Status Feedback","description":"## Kontext\n`abs library scan` existiert bereits, aber:\n- Kein --force Flag (ABS API unterstützt ?force=1)\n- Kein Feedback ob der Scan noch läuft oder fertig ist\n\n## Verbesserungen\n1. `abs library scan --force` → POST /api/libraries/{id}/scan?force=1\n2. Nach Scan-Trigger: Poll lastScan Timestamp bis er sich ändert (optional --wait)\n3. Ausgabe: \"Scan gestartet\" / \"Scan abgeschlossen (X neue Items, Y entfernt)\"\n\n## API Details\n- POST /api/libraries/{id}/scan[?force=1] → \"OK\" (text/plain)\n- GET /api/libraries/{id} → { lastScan: timestamp_ms, lastScanVersion: \"...\" }\n\n## Akzeptanzkriterien\n- [ ] --force Flag wird an API weitergereicht\n- [ ] --wait pollt bis Scan fertig (lastScan ändert sich)\n- [ ] Ohne --wait: \"Scan gestartet\" Meldung","status":"open","priority":3,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-18T02:35:50Z","created_by":"Malte Sussdorff","updated_at":"2026-02-18T02:35:50Z"}
{"id":"abs-cli-6uh","title":"Enhancement: Hörstatus in Items-Liste + erweiterte Suche","status":"closed","priority":2,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-18T03:42:30Z","created_by":"Malte Sussdorff","updated_at":"2026-02-18T03:42:36Z","closed_at":"2026-02-18T03:42:36Z","close_reason":"items list: Status-Spalte + --listened/--not-listened Filter via /me Endpunkt; search: zeigt Autoren, Serien, Sprecher"}
{"id":"abs-cli-7j2","title":"Projekt-Scaffolding: Click CLI + httpx + Config","description":"## Ziel\nGrundgerüst für abs-cli aufsetzen.\n\n## Details\n- Click-basiertes CLI mit Gruppen (library, items, progress)\n- httpx Client-Klasse für ABS REST-API\n- Config via XDG (~/.config/abs-cli/config.toml): server_url, api_token\n- 1Password-Integration: falls kein Token in Config, via `op read` aus 1Password\n- Rich für hübsche Tabellen-Ausgabe\n- UV dependencies: click, httpx, rich, tomli/tomllib\n\n## Akzeptanzkriterien\n- [ ] `abs --help` zeigt Kommandogruppen\n- [ ] Config wird aus XDG gelesen\n- [ ] API-Client verbindet sich zum ABS-Server\n- [ ] 1Password Fallback funktioniert","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-17T19:06:43Z","created_by":"Malte Sussdorff","updated_at":"2026-02-17T20:25:14Z","closed_at":"2026-02-17T20:25:14Z","close_reason":"Click CLI mit 3 Gruppen (library, items, progress), httpx ABSClient, XDG config + 1Password Fallback"}
{"id":"abs-cli-7js","title":"items cleanup: Batch-Delete von isMissing Items","description":"## Kontext\nABS markiert Items als isMissing wenn die Dateien vom Filesystem gelöscht werden. \nForce-Rescan entfernt sie NICHT automatisch. Manuelles Löschen über die API ist nötig.\n\n## Kommando\n`abs items cleanup [--library=ID] [--dry-run/--no-dry-run]`\n\nDry-run ist default (wie bei delete).\n\n## Logik\n1. GET /api/libraries/{id}/items?limit=0\n2. Filter: select(.isMissing == true)\n3. Tabelle der zu löschenden Items anzeigen\n4. POST /api/items/batch/delete mit {\"libraryItemIds\": [...]}\n\n## API-Erkenntnis\n- Batch-Delete Endpoint: `POST /api/items/batch/delete` mit Body `{\"libraryItemIds\": [\"id1\", \"id2\", ...]}`\n- Antwort: \"OK\" (text/plain)\n- isMissing Items haben audioFiles=0 und duration=0\n\n## Akzeptanzkriterien\n- [ ] `abs items cleanup --library=ID` zeigt isMissing Items (dry-run)\n- [ ] `abs items cleanup --library=ID --no-dry-run` löscht sie\n- [ ] Ausgabe: Anzahl gelöschter Items + Titelliste\n- [ ] Leere Liste → freundliche Meldung (\"Keine fehlenden Items\")","status":"open","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-18T02:35:17Z","created_by":"Malte Sussdorff","updated_at":"2026-02-18T02:35:17Z"}
{"id":"abs-cli-9ff","title":"Library-Kommandos: list, scan, stats","description":"## Kommandos\n- `abs library list` — Alle Libraries auflisten\n- `abs library scan [--force]` — Library Rescan triggern\n- `abs library stats` — Statistiken (Anzahl Items, Größe, etc.)\n\n## API Endpoints\n- GET /api/libraries\n- POST /api/libraries/{id}/scan\n- GET /api/libraries/{id}/stats","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-17T19:06:58Z","created_by":"Malte Sussdorff","updated_at":"2026-02-17T20:25:15Z","closed_at":"2026-02-17T20:25:15Z","close_reason":"3 Kommandos (list, scan, stats) mit Rich-Tabellen, Library/LibraryStats Dataclasses","dependencies":[{"issue_id":"abs-cli-9ff","depends_on_id":"abs-cli-7j2","type":"blocks","created_at":"2026-02-17T20:07:03Z","created_by":"Malte Sussdorff","metadata":"{}"}]}
{"id":"abs-cli-hga","title":"Progress-Kommandos: list, sync-from-libation","description":"## Kommandos\n- `abs progress list [--finished] [--in-progress]` — Hörfortschritt auflisten\n- `abs progress sync --from-libation [--apply]` — Read-Status aus Libation DB syncen (dry-run default)\n\n## Details\n- Übernimmt Logik aus sync-read-status.py\n- Libation DB: SQLite mit UserDefinedItem.IsFinished + Books.AudibleProductId\n- Matching via ASIN → ABS media.metadata.asin\n- PATCH /api/me/progress/{itemId} zum Setzen\n\n## API Endpoints\n- GET /api/me/items-in-progress\n- PATCH /api/me/progress/{itemId}","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-17T19:06:58Z","created_by":"Malte Sussdorff","updated_at":"2026-02-17T20:25:18Z","closed_at":"2026-02-17T20:25:18Z","close_reason":"2 Kommandos (list, sync), Libation SQLite→ABS ASIN-Matching, dry-run Default","dependencies":[{"issue_id":"abs-cli-hga","depends_on_id":"abs-cli-7j2","type":"blocks","created_at":"2026-02-17T20:07:04Z","created_by":"Malte Sussdorff","metadata":"{}"}]}
{"id":"abs-cli-oli","title":"items import: Lokale Audiobook-Dateien in ABS importieren","description":"## Kontext\nBeim Import von lokalen m4b-Dateien nach ABS muss man:\n1. Den richtigen Zielpfad im ABS Docker Volume kennen (Author/Series/BookTitle/)\n2. Die Datei dorthin kopieren (rsync/scp + pct push bei LXC)\n3. ABS Library Scan triggern\n\nAktuell ist das alles manuell. Das CLI sollte zumindest den Pfad-Lookup und Scan-Trigger automatisieren.\n\n## Kommando\n`abs items import \u003cfile\u003e --library=ID [--author \"...\"] [--series \"...\"] [--title \"...\"]`\n\n## Logik\n1. Datei-Metadaten auslesen (m4b tags via mutagen/tinytag)\n2. Ziel-Ordner bestimmen: Author/[Series/]Title/\n3. Wenn Item existiert → warnen (überschreiben nur mit --force)\n4. Datei kopieren (lokal oder via SSH)\n5. Library Scan triggern\n\n## Offene Fragen\n- Soll das Tool direkt SSH/pct push machen, oder nur den Pfad ausgeben?\n- Wie mit der LXC-Schicht umgehen (Proxmox Host → LXC Container)?\n\n## Akzeptanzkriterien\n- [ ] Datei wird in korrekten ABS-Ordner kopiert\n- [ ] Metadaten (Author, Title, Series) werden aus m4b-Tags gelesen\n- [ ] Library Scan wird automatisch getriggert\n- [ ] Dry-run zeigt was passieren würde\n- [ ] Bestehende Items werden nicht überschrieben (ohne --force)","status":"open","priority":2,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-18T02:35:39Z","created_by":"Malte Sussdorff","updated_at":"2026-02-18T02:35:39Z"}
{"id":"abs-cli-qxd","title":"audible-cli auf ABS LXC einrichten + Audible→ABS Hörstatus-Sync","description":"## Ziel\naudible-cli auf LXC 110 (Audiobookshelf) einrichten, um:\n1. Audible Hörstatus (is_finished) nach ABS zu syncen\n2. Optional: Neue Käufe automatisch herunterladen\n\n## Schritte\n1. audible-cli auf LXC 110 installieren (pip/pipx)\n2. Audible-Account authentifizieren (einmalig, Browser-Flow)\n3. `audible library export` testen — CSV/JSON mit is_finished\n4. abs-cli erweitern: `abs progress sync --from-audible-export \u003cfile\u003e`\n   - Liest CSV/JSON von audible-cli export\n   - Matching via ASIN → ABS Items\n   - Setzt isFinished in ABS (dry-run default)\n5. Optional: Cron-Job auf LXC für automatischen Sync\n\n## Entscheidung\naudible-cli als externe CLI-Dependency auf dem Server, NICHT als Python-Library in abs-cli eingebunden.\nGrund: Auth liegt auf dem Server, kein Browser-OAuth-Flow nötig in abs-cli, keine extra Dependency.\n\n## Akzeptanzkriterien\n- [ ] audible-cli auf LXC 110 installiert und authentifiziert\n- [ ] Library-Export mit Hörstatus funktioniert\n- [ ] `abs progress sync --from-audible-export` implementiert\n- [ ] Dry-Run zeigt korrekte Matches und Status\n- [ ] --apply synct tatsächlich den Status nach ABS","notes":"Auth muss interaktiv auf LXC 110 passieren (Amazon 2FA). User muss  selbst ausführen.","status":"closed","priority":2,"issue_type":"feature","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-18T03:47:59Z","created_by":"Malte Sussdorff","updated_at":"2026-02-18T04:08:20Z","closed_at":"2026-02-18T04:08:20Z","close_reason":"audible-cli auf LXC 110 installiert+authentifiziert, --from-audible-export implementiert (JSON/TSV/CSV), _build_asin_index fix fuer /me Progress, 198 Buecher erfolgreich synchronisiert","labels":["decision"]}
{"id":"abs-cli-w69","title":"Item-Kommandos: list, show, match, delete, search","description":"## Kommandos\n- `abs items list [--missing] [--unmatched] [--library=ID]` — Items auflisten mit Filtern\n- `abs items show \u003cid\u003e` — Detail-Ansicht eines Items\n- `abs items match \u003cid|--all\u003e [--provider=audible]` — Metadata-Match\n- `abs items delete \u003cid\u003e [--missing-only] [--dry-run]` — Items löschen (dry-run default!)\n- `abs items search \u003cquery\u003e` — Freitextsuche\n\n## API Endpoints\n- GET /api/libraries/{id}/items\n- GET /api/items/{id}\n- POST /api/items/{id}/match\n- DELETE /api/items/{id}\n- GET /api/libraries/{id}/search","status":"closed","priority":2,"issue_type":"task","owner":"malte.sussdorff@cognovis.de","created_at":"2026-02-17T19:06:58Z","created_by":"Malte Sussdorff","updated_at":"2026-02-17T20:25:16Z","closed_at":"2026-02-17T20:25:16Z","close_reason":"5 Kommandos (list, show, match, delete, search) mit dry-run Default, Rich Panel/Tabellen","dependencies":[{"issue_id":"abs-cli-w69","depends_on_id":"abs-cli-7j2","type":"blocks","created_at":"2026-02-17T20:07:04Z","created_by":"Malte Sussdorff","metadata":"{}"}]}
